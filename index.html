<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的主页</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #141414;
            --bg-card: #1a1a1a;
            --bg-hover: #2a2a2a;

            --text-primary: #ffffff;
            --text-secondary: #eeeeee;
            --text-muted: #bbbbbb;

            --border: #5a5a5a;
            --accent: #4285f4;
            --accent-hover: #3367d6;

            /* Card backdrop for dark mode */
            --card-backdrop: rgba(26, 26, 26, 0.75);
        }

        /* Light Theme */
        :root[data-theme="light"] {
            --bg-primary: #F6F7F9;
            --bg-secondary: #f5f5f5;
            --bg-card: #ffffff;
            --bg-hover: #f0f0f0;

            --text-primary: #000000;
            --text-secondary: #4a4a4a;
            --text-muted: #888888;

            --border: #d0d0d0;
            --accent: #4285f4;
            --accent-hover: #3367d6;

            /* Card backdrop for light mode */
            --card-backdrop: rgba(255, 255, 255, 0.5);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: transparent;
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Background layer for light mode */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: -1;
            transition: background-color 0.3s ease;
        }

        /* Background color for top bar and footer */
        .top-bar {
            background: var(--bg-primary);
        }

        /* Background for main content area (between top bar and footer) */
        .main-content {
            background: transparent;
        }

        /* ========================================
           Dynamic Background - Starry Sky Style
           Random blocks with appearance/disappearance
           ======================================== */

        .starry-bg {
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            pointer-events: none;
            z-index: 0;
        }

        /* Star layer 1 */
        .starry-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(2px 2px at 8% 12%, rgba(255, 255, 255, 0.60), transparent 2px),
                radial-gradient(2px 2px at 23% 34%, rgba(255, 255, 255, 0.70), transparent 2px),
                radial-gradient(2px 2px at 37% 18%, rgba(255, 255, 255, 0.55), transparent 2px),
                radial-gradient(2px 2px at 51% 42%, rgba(255, 255, 255, 0.65), transparent 2px),
                radial-gradient(2px 2px at 65% 26%, rgba(255, 255, 255, 0.50), transparent 2px),
                radial-gradient(2px 2px at 79% 38%, rgba(255, 255, 255, 0.68), transparent 2px),
                radial-gradient(2px 2px at 93% 22%, rgba(255, 255, 255, 0.58), transparent 2px),
                radial-gradient(2px 2px at 14% 56%, rgba(255, 255, 255, 0.62), transparent 2px),
                radial-gradient(2px 2px at 28% 70%, rgba(255, 255, 255, 0.52), transparent 2px),
                radial-gradient(2px 2px at 42% 54%, rgba(255, 255, 255, 0.66), transparent 2px),
                radial-gradient(1.5px 1.5px at 5% 25%, rgba(255, 255, 255, 0.30), transparent 1.5px),
                radial-gradient(1.5px 1.5px at 18% 45%, rgba(255, 255, 255, 0.38), transparent 1.5px),
                radial-gradient(1.5px 1.5px at 31% 65%, rgba(255, 255, 255, 0.25), transparent 1.5px),
                radial-gradient(1px 1px at 3% 8%, rgba(255, 255, 255, 0.15), transparent 1px),
                radial-gradient(1px 1px at 15% 28%, rgba(255, 255, 255, 0.18), transparent 1px),
                radial-gradient(1px 1px at 27% 48%, rgba(255, 255, 255, 0.12), transparent 1px);
            background-size: 50% 50%;
            animation: rotate-stars 300s linear infinite, star-twinkle-1 4s ease-in-out infinite alternate;
        }

        /* Star layer 2 */
        .starry-bg::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(2px 2px at 7% 31%, rgba(255, 255, 255, 0.52), transparent 2px),
                radial-gradient(2px 2px at 19% 51%, rgba(255, 255, 255, 0.62), transparent 2px),
                radial-gradient(2px 2px at 31% 71%, rgba(255, 255, 255, 0.50), transparent 2px),
                radial-gradient(2px 2px at 43% 91%, rgba(255, 255, 255, 0.65), transparent 2px),
                radial-gradient(2px 2px at 55% 21%, rgba(255, 255, 255, 0.54), transparent 2px),
                radial-gradient(2px 2px at 67% 41%, rgba(255, 255, 255, 0.58), transparent 2px),
                radial-gradient(1.5px 1.5px at 4% 44%, rgba(255, 255, 255, 0.25), transparent 1.5px),
                radial-gradient(1.5px 1.5px at 16% 64%, rgba(255, 255, 255, 0.40), transparent 1.5px),
                radial-gradient(1px 1px at 2% 19%, rgba(255, 255, 255, 0.12), transparent 1px),
                radial-gradient(1px 1px at 14% 39%, rgba(255, 255, 255, 0.16), transparent 1px);
            background-size: 50% 50%;
            animation: rotate-stars 300s linear infinite reverse, star-twinkle-2 5s ease-in-out infinite alternate;
        }

        /* Light mode - larger soft dots */
        :root[data-theme="light"] .starry-bg::before {
            background-image:
                radial-gradient(8px 8px at 8% 12%, rgba(0, 0, 0, 0.14), transparent 8px),
                radial-gradient(10px 10px at 23% 34%, rgba(0, 0, 0, 0.16), transparent 10px),
                radial-gradient(6px 6px at 37% 18%, rgba(0, 0, 0, 0.12), transparent 6px),
                radial-gradient(12px 12px at 51% 42%, rgba(0, 0, 0, 0.15), transparent 12px),
                radial-gradient(7px 7px at 65% 26%, rgba(0, 0, 0, 0.11), transparent 7px),
                radial-gradient(9px 9px at 79% 38%, rgba(0, 0, 0, 0.17), transparent 9px),
                radial-gradient(6px 6px at 93% 22%, rgba(0, 0, 0, 0.13), transparent 6px),
                radial-gradient(11px 11px at 14% 56%, rgba(0, 0, 0, 0.14), transparent 11px),
                radial-gradient(8px 8px at 28% 70%, rgba(0, 0, 0, 0.12), transparent 8px),
                radial-gradient(10px 10px at 42% 54%, rgba(0, 0, 0, 0.16), transparent 10px);
        }

        :root[data-theme="light"] .starry-bg::after {
            background-image:
                radial-gradient(9px 9px at 7% 31%, rgba(0, 0, 0, 0.13), transparent 9px),
                radial-gradient(7px 7px at 19% 51%, rgba(0, 0, 0, 0.15), transparent 7px),
                radial-gradient(11px 11px at 31% 71%, rgba(0, 0, 0, 0.11), transparent 11px),
                radial-gradient(8px 8px at 43% 91%, rgba(0, 0, 0, 0.14), transparent 8px),
                radial-gradient(10px 10px at 55% 21%, rgba(0, 0, 0, 0.12), transparent 10px),
                radial-gradient(6px 6px at 67% 41%, rgba(0, 0, 0, 0.13), transparent 6px),
                radial-gradient(12px 12px at 4% 44%, rgba(0, 0, 0, 0.10), transparent 12px),
                radial-gradient(7px 7px at 16% 64%, rgba(0, 0, 0, 0.16), transparent 7px);
        }

        /* Hide mist elements */
        .mist-blob-1,
        .mist-blob-2,
        .mist-blob-footer {
            display: none;
        }

        /* Twinkle animations */
        @keyframes star-twinkle-1 {
            0% { opacity: 1; }
            50% { opacity: 0.85; }
            100% { opacity: 1; }
        }

        @keyframes star-twinkle-2 {
            0% { opacity: 1; }
            50% { opacity: 0.80; }
            100% { opacity: 1; }
        }

        @keyframes rotate-stars {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Top Bar */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 48px;
            padding: 0 32px;
            border-bottom: 1px solid var(--border);
            font-size: 13px;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
            background: var(--bg-primary);
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        .top-left {
            display: flex;
            align-items: center;
            gap: 16px;
            height: 100%;
        }

        .separator {
            color: var(--border);
            font-size: 12px;
            opacity: 0.5;
            margin: 0 0;
            transition: color 0.3s ease;
        }

        #time {
            font-weight: 600;
            color: var(--text-primary);
            font-variant-numeric: tabular-nums;
            font-size: 14px;
            transition: color 0.3s ease;
        }

        #date {
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        #weather {
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        .work-countdown {
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        .work-countdown .highlight {
            color: var(--accent);
            font-weight: 600;
        }

        /* Top Bar Theme Toggle (Notion/Linear style) */
        .theme-toggle {
            position: fixed;
            top: 10px;
            right: 32px;
            width: 28px;
            height: 28px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
            z-index: 100;
        }

        .theme-toggle svg {
            width: 18px;
            height: 18px;
            stroke: currentColor;
            stroke-width: 1.5;
            fill: none;
            opacity: 0.5;
            transition: all 0.15s ease;
        }

        .theme-toggle:hover svg {
            fill: currentColor;
            opacity: 1;
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        /* Hide sun icon in dark mode, moon in light mode */
        :root:not([data-theme="light"]) .theme-toggle .sun-icon,
        :root[data-theme="light"] .theme-toggle .moon-icon {
            display: none;
        }

        :root[data-theme="light"] .theme-toggle .sun-icon,
        :root:not([data-theme="light"]) .theme-toggle .moon-icon {
            display: block;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .icon-btn svg {
            width: 18px;
            height: 18px;
            stroke: currentColor;
        }

        .icon-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: #4285f4;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 80px 32px 32px 32px;
            position: relative;
            min-height: 0;
        }

        /* Welcome Message */
        .welcome-message {
            text-align: center;
            margin-top: 0;
            margin-bottom: 48px;
            flex-shrink: 0;
        }

        .welcome-message h1 {
            font-size: 28px;
            font-weight: 500;
            color: #1A1A1A;
            margin: 0;
            letter-spacing: 0.02em;
            opacity: 0.9;
            transition: color 0.3s ease;
        }

        :root:not([data-theme="light"]) .welcome-message h1 {
            color: #ffffff;
        }

        /* Search Section - HERO */
        .search-hero {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 1000px;
            margin-bottom: 64px;
            flex-shrink: 0;
        }

        /* Search Engine Selector - Tag Style (Notion/Linear) */
        .engine-selector {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 24px;
            margin-bottom: 20px;
            padding: 0;
            background: transparent;
            border: none;
        }

        .engine-option {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 22px;
            border-radius: 6px;
            border: none;
            background: transparent;
            color: rgba(255, 255, 255, 0.35);
            font-size: 15px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .engine-option::before,
        .engine-option::after {
            content: '';
            display: inline-block;
            width: 0.3em;
            visibility: hidden;
        }

        .engine-option.active::before,
        .engine-option.active::after {
            visibility: visible;
        }

        :root[data-theme="light"] .engine-option {
            color: rgba(0, 0, 0, 0.35);
        }

        .engine-option svg {
            width: 16px;
            height: 16px;
            opacity: 0.5;
            transition: all 0.15s ease;
        }

        .engine-option:hover {
            color: rgba(255, 255, 255, 0.6);
        }

        .engine-option:hover::before,
        .engine-option:hover::after {
            content: '[';
            color: rgba(255, 255, 255, 0.25);
            font-weight: 400;
            visibility: visible;
        }

        .engine-option:hover::after {
            content: ']';
        }

        :root[data-theme="light"] .engine-option:hover {
            color: rgba(0, 0, 0, 0.6);
        }

        :root[data-theme="light"] .engine-option:hover::before,
        :root[data-theme="light"] .engine-option:hover::after {
            color: rgba(0, 0, 0, 0.20);
        }

        .engine-option:hover svg {
            opacity: 0.7;
        }

        .engine-option.active {
            background: transparent;
            color: rgba(255, 255, 255, 0.95);
        }

        .engine-option.active::before,
        .engine-option.active::after {
            content: '[';
            color: #4285f4;
            font-weight: 400;
            visibility: visible;
        }

        .engine-option.active::after {
            content: ']';
        }

        :root[data-theme="light"] .engine-option.active {
            background: transparent;
            color: rgba(0, 0, 0, 0.85);
        }

        :root[data-theme="light"] .engine-option.active::before,
        :root[data-theme="light"] .engine-option.active::after {
            color: rgba(26, 115, 232, 0.5);
        }

        .engine-option.active svg {
            opacity: 1;
        }

        /* Search Container */
        .search-container {
            position: relative;
            width: 100%;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.10);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: rgba(0, 0, 0, 0.05) 0 3px 16px;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.3s ease, border-color 0.3s ease;
        }

        :root[data-theme="light"] .search-container {
            background: #ffffff;
            border: 1px solid rgba(0, 0, 0, 0.12);
            box-shadow: rgba(0, 0, 0, 0.05) 0 3px 16px;
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
        }

        .search-container:focus-within {
            border-color: var(--accent);
            box-shadow: rgba(66, 133, 244, 0.25) 0 4px 20px, 0 0 0 3px rgba(66, 133, 244, 0.15);
            transform: translateY(-2px);
            z-index: 10000;
        }

        :root[data-theme="light"] .search-container:focus-within {
            border-color: var(--accent);
            box-shadow: rgba(66, 133, 244, 0.20) 0 4px 20px, 0 0 0 3px rgba(66, 133, 244, 0.12);
        }

        /* Search Suggestions */
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 18px;
            margin-top: 8px;
            max-height: 300px;
            display: none;
            flex-direction: column;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            z-index: 9999;
        }

        .search-suggestions.show {
            display: flex;
        }

        .suggestion-header {
            flex-shrink: 0;
            padding: 10px 16px;
            font-size: 12px;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .suggestion-list {
            flex: 1;
            overflow-y: auto;
            min-height: 0;
        }

        .suggestion-item {
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.15s;
        }

        .suggestion-item:hover {
            background: var(--bg-hover);
        }

        .suggestion-item.selected {
            background: var(--bg-hover);
        }

        .suggestion-icon {
            width: 16px;
            height: 16px;
            opacity: 0.5;
        }

        .suggestion-text {
            flex: 1;
            font-size: 14px;
            color: var(--text-primary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .suggestion-empty {
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 13px;
        }

        .suggestion-empty-hint {
            padding: 32px 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 13px;
        }

        .suggestion-empty-hint svg {
            width: 32px;
            height: 32px;
            margin-bottom: 8px;
            opacity: 0.4;
        }

        .suggestion-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 20px;
            color: var(--text-muted);
            font-size: 13px;
        }

        .loading-spinner {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .search-input {
            width: 100%;
            padding: 20px 70px 20px 20px;
            background: transparent;
            border: none;
            border-radius: 18px;
            font-size: 17px;
            color: var(--text-primary);
            outline: none;
        }

        .search-input::placeholder {
            color: #6B7280;
        }

        :root:not([data-theme="light"]) .search-input::placeholder {
            color: rgba(255, 255, 255, 0.55);
        }

        .search-icons {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .search-icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .search-icon-btn svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
        }

        .search-icon-btn:hover {
            background: var(--bg-hover);
            color: #4285f4;
        }

        /* Icon styles */
        .icon {
            width: 18px;
            height: 18px;
            stroke: currentColor;
        }

        /* Quick Links Under Search */
        .quick-links {
            width: 100%;
            max-width: 1100px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 4px 12px 4px;
            position: relative;
        }

        .quick-links-container {
            display: grid;
            grid-auto-columns: 120px;
            grid-auto-flow: column;
            gap: clamp(12px, 2vh, 20px);
            overflow-x: auto;
            overflow-y: visible;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            padding: 8px 4px 18px 4px;
            scroll-snap-type: x mandatory;
            scrollbar-gutter: stable;
        }

        /* Mobile scroll hint */
        .scroll-hint {
            display: none;
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 60px;
            background: linear-gradient(to left, var(--bg-primary), transparent);
            pointer-events: none;
            align-items: center;
            justify-content: center;
            animation: scrollHint 2s ease-in-out infinite;
        }

        .scroll-hint::after {
            content: '';
            width: 8px;
            height: 8px;
            border-right: 2px solid var(--text-muted);
            border-bottom: 2px solid var(--text-muted);
            transform: rotate(-45deg);
            margin-right: 12px;
        }

        @keyframes scrollHint {
            0%, 100% { opacity: 0.3; transform: translateY(-50%) translateX(0); }
            50% { opacity: 1; transform: translateY(-50%) translateX(5px); }
        }

        @media (max-width: 600px) {
            .scroll-hint {
                display: flex;
            }
        }

        /* Hide scrollbar by default */
        .quick-links-container::-webkit-scrollbar {
            height: 6px;
        }

        .quick-links-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .quick-links-container::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 3px;
            transition: background 0.2s;
        }

        /* Show scrollbar on hover */
        .quick-links-container:hover::-webkit-scrollbar-thumb {
            background: var(--border);
        }

        .quick-links-container:hover::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Firefox */
        .quick-links-container {
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
        }

        .quick-links-container:hover {
            scrollbar-color: var(--border) transparent;
        }

        .quick-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: clamp(8px, 1.5vh, 12px);
            width: 120px;
            height: 120px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 18px;
            text-decoration: none;
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s, border-color 0.3s ease, color 0.3s ease;
            white-space: nowrap;
            scroll-snap-align: start;
        }

        .quick-link .icon {
            width: 34px;
            height: 34px;
            stroke: #6B7280;
        }

        .quick-link:hover .icon {
            stroke: #111;
        }

        :root:not([data-theme="light"]) .quick-link:hover .icon {
            stroke: #ffffff;
        }

        .quick-link:hover {
            background: var(--card-backdrop);
            border-color: #4285f4;
            color: var(--text-primary);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: clamp(12px, 2vh, 16px);
            width: 100%;
            max-width: 1000px;
        }

        .dash-card {
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: clamp(12px, 1.8vh, 20px);
            transition: all 0.2s;
        }

        .dash-card:hover {
            background: var(--card-backdrop);
            border-color: #4285f4;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
        }

        .card-icon {
            width: 32px;
            height: 32px;
            border-radius: 10px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border);
        }

        .dash-card:hover .card-icon {
            background: var(--card-backdrop);
        }

        .card-icon svg {
            width: 18px;
            height: 18px;
            stroke: var(--text-secondary);
        }

        .card-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--accent);
        }

        /* Stats */
        .stats-row {
            display: flex;
            gap: 12px;
        }

        .stat-item {
            flex: 1;
            text-align: center;
            padding: 12px;
            background: transparent;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .stat-item:hover {
            background: var(--card-backdrop);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: var(--accent);
            line-height: 1;
        }

        .stat-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* Task List */
        .task-list {
            list-style: none;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: transparent;
            border-radius: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.15s;
            border: 1px solid var(--border);
        }

        .task-item:hover {
            background: var(--card-backdrop);
        }

        .task-check {
            width: 14px;
            height: 14px;
            border: 2px solid var(--text-muted);
            border-radius: 50%;
            flex-shrink: 0;
        }

        .task-text {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Info Items */
        .info-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            font-size: 13px;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 24px 16px 40px 16px;
            font-size: 12px;
            color: #9CA3AF;
            border-top: none;
            position: relative;
            background: transparent;
            transition: color 0.3s ease;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-muted);
            font-size: 13px;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-top-color: #4285f4;
            border-radius: 50%;
            margin: 0 auto 12px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 900px) {
            .search-hero {
                max-width: 700px;
            }

            .quick-links {
                max-width: 700px;
            }

            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .top-bar {
                flex-direction: column;
                gap: 8px;
                padding: 10px 16px;
                font-size: 12px;
            }

            .top-left {
                flex-wrap: wrap;
                gap: 6px 8px;
                justify-content: center;
            }

            .separator {
                display: none;
            }

            .work-countdown {
                width: 100%;
                text-align: center;
            }

            .search-hero {
                max-width: 100%;
                margin-bottom: 50px;
            }

            .welcome-message {
                margin-bottom: 24px;
            }

            .welcome-message h1 {
                font-size: 24px;
            }

            .engine-selector {
                gap: 6px;
            }

            .engine-option {
                padding: 8px 14px;
                font-size: 13px;
            }

            .engine-option svg {
                width: 16px;
                height: 16px;
            }

            .search-input {
                padding: 16px 60px 16px 16px;
                font-size: 16px;
            }

            .search-icon-btn {
                width: 36px;
                height: 36px;
            }

            .search-icon-btn svg {
                width: 18px;
                height: 18px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .quick-links {
                max-width: 100%;
            }

            .quick-links-container {
                gap: 12px;
                padding: 6px;
            }

            .quick-link {
                width: 76px;
                height: 76px;
                font-size: 10px;
            }

            .quick-link .icon {
                width: 22px;
                height: 22px;
            }
        }

        /* Notion Quick Links */
        .notion-links {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            max-width: 1100px;
            margin: 0 auto 48px auto;
            padding: 8px 0;
            flex-shrink: 0;
        }

        .notion-links::before,
        .notion-links::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--border), transparent);
        }

        .notion-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 18px;
            text-decoration: none;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s, color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
            border-radius: 18px;
            border: 1px solid transparent;
            background: transparent;
        }

        .notion-link:hover {
            color: var(--text-primary);
            background: var(--card-backdrop);
            border-color: #4285f4;
            backdrop-filter: blur(8px);
        }

        .notion-link svg {
            width: 18px;
            height: 18px;
            stroke: #6B7280;
            transition: all 0.2s;
        }

        .notion-link:hover svg {
            stroke: #111;
        }

        :root:not([data-theme="light"]) .notion-link:hover svg {
            stroke: #ffffff;
        }

        .notion-link-main {
            color: var(--text-primary);
            font-weight: 600;
        }

        .notion-link-main svg {
            stroke: var(--text-primary);
        }

        /* Compact layout for smaller viewport heights */
        @media (max-height: 760px) {
            .main-content {
                padding: 48px 24px 24px 24px;
            }

            .welcome-message {
                margin-bottom: 32px;
            }

            .welcome-message h1 {
                font-size: 24px;
            }

            .engine-selector {
                margin-bottom: 32px;
            }

            .search-hero {
                margin-bottom: 40px;
            }

            .notion-links {
                margin: 0 auto 40px auto;
                padding: 12px 0;
            }

            .quick-links {
                padding: 0 4px 4px 4px;
            }

            .dashboard-grid {
                gap: 12px;
            }

            .dash-card {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Starry Background -->
    <div class="starry-bg">
        <svg id="geoSvg" viewBox="0 0 1920 1080" preserveAspectRatio="xMidYMid slice"></svg>
        <!-- Morning mist blobs (light mode only) -->
        <div class="mist-blob-1"></div>
        <div class="mist-blob-2"></div>
        <div class="mist-blob-footer"></div>
    </div>

    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-left">
            <span id="time">--:--</span>
            <span class="separator">·</span>
            <span id="date">加载中...</span>
            <span class="separator">·</span>
            <span id="weather" class="weather">定位中...</span>
            <span class="separator">·</span>
            <span id="workCountdown" class="work-countdown">加载中...</span>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Welcome Message -->
        <div class="welcome-message">
            <h1 id="greeting">你好</h1>
        </div>

        <!-- Search Hero -->
        <div class="search-hero">
            <div class="engine-selector" id="engineSelector">
                <button class="engine-option active" data-engine="google">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    <span>Google</span>
                </button>
                <button class="engine-option" data-engine="bing">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/></svg>
                    <span>Bing</span>
                </button>
                <button class="engine-option" data-engine="baidu">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"/><path d="M8.5 8.5a2.5 2.5 0 0 0 0 5"/><path d="M15.5 8.5a2.5 2.5 0 0 0 0 5"/></svg>
                    <span>Baidu</span>
                </button>
            </div>
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="今天想了解什么？" autofocus autocomplete="off">
                <div class="search-icons">
                    <button class="search-icon-btn" id="clearSearch" title="清空" style="display: none;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                    </button>
                    <button class="search-icon-btn" id="searchBtn" title="搜索">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </button>
                </div>
                <!-- Search Suggestions -->
                <div class="search-suggestions" id="searchSuggestions">
                    <div class="suggestion-header">
                        <span>搜索建议</span>
                    </div>
                    <div class="suggestion-list" id="suggestionList"></div>
                </div>
            </div>
        </div>

        <!-- Notion Quick Links -->
        <div class="notion-links">
            <a href="notion://" class="notion-link notion-link-main">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg>
                Notion
            </a>
            <a href="https://www.notion.so/A01-64584211a9364743a4530c3edd24292e?pvs=21" target="_blank" class="notion-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/><path d="M12 11h.01"/><path d="M8 11h.01"/><path d="M16 11h.01"/></svg>
                收集箱
            </a>
            <a href="https://www.notion.so/A02-75ed3e011173435394c946bbcfbcc3d8?pvs=21" target="_blank" class="notion-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/></svg>
                碎片池
            </a>
            <a href="https://www.notion.so/B01-e10f090ec3f646e8b9c6e67decafbd3d?pvs=21" target="_blank" class="notion-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                工作日志
            </a>
            <a href="https://www.notion.so/B03-3c66c113d7e244b8a40d919da2e2571f?pvs=21" target="_blank" class="notion-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
                任务列表
            </a>
        </div>

            <div class="quick-links">
                <div class="scroll-hint" id="scrollHint"></div>
                <div class="quick-links-container" id="quickLinksContainer">
                    <a href="https://mail.qiye.163.com/static/login/" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                        <span>企业邮箱</span>
                    </a>
                    <a href="https://chat.openai.com" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></svg>
                        <span>ChatGPT</span>
                    </a>
                    <a href="https://bigmodel.cn/console/overview" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M12 16v4"/><path d="M8 12h8"/><circle cx="12" cy="12" r="10"/><path d="M9 20h6"/></svg>
                        <span>智谱AI</span>
                    </a>
                    <a href="https://github.com" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
                        <span>GitHub</span>
                    </a>
                    <a href="https://www.v2ex.com" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                        <span>V2EX</span>
                    </a>
                    <a href="https://fanyi.baidu.com/" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 8h14"/><path d="M5 12h14"/><path d="M5 16h14"/><path d="m17 8-4 4 4 4"/><path d="M7 12h.01"/></svg>
                        <span>百度翻译</span>
                    </a>
                    <a href="https://momoyu.cc/" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
                        <span>在线学习</span>
                    </a>
                    <a href="https://www.zhihu.com" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
                        <span>知乎</span>
                    </a>
                    <a href="https://www.bilibili.com" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                        <span>哔哩哔哩</span>
                    </a>
                    <a href="https://www.youtube.com/" target="_blank" class="quick-link">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17"/><path d="m10 15 5-3-5-3z"/></svg>
                        <span>YouTube</span>
                    </a>
                </div>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>© 2025 – 2026 你想堆个雪人吗 &nbsp;|&nbsp; Last update: 2025-12-24 &nbsp;|&nbsp; Powered by Claude, Notion & Web Tech</p>
    </footer>

    <!-- Floating Theme Toggle -->
    <button class="theme-toggle" id="themeToggle" title="切换主题">
        <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
        <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
    </button>

    <script>
        // Random geometric shapes generator (optimized)
        function generateGeometricShapes() {
            const svg = document.getElementById('geoSvg');
            if (!svg) return;

            // Check if light theme
            if (document.documentElement.getAttribute('data-theme') === 'light') {
                // Clear existing shapes
                svg.innerHTML = '';

                // Morandi colors
                const colors = ['#E8D5D0', '#D4E2E8', '#E5D5E8', '#D5E8DB', '#E8E5D5', '#D5DEE8', '#E0D5E0', '#D5E0E5'];

                // Generate 2-3 random shapes (reduced by ~30%)
                const shapeCount = 2 + Math.floor(Math.random() * 2);

                // Pre-inject unified keyframe animations
                let existingStyle = document.getElementById('geo-keyframes');
                if (!existingStyle) {
                    const style = document.createElement('style');
                    style.id = 'geo-keyframes';
                    style.textContent = `
                        @keyframes geoFloat1 {
                            0%, 100% { transform: translate(-3%, -2%) scale(0.95); }
                            50% { transform: translate(3%, 2%) scale(1.05); }
                        }
                        @keyframes geoFloat2 {
                            0%, 100% { transform: translate(2%, -3%) scale(1.02); }
                            50% { transform: translate(-2%, 3%) scale(0.98); }
                        }
                        @keyframes geoFloat3 {
                            0%, 100% { transform: translate(-2%, 2%) scale(0.98); }
                            50% { transform: translate(2%, -2%) scale(1.02); }
                        }
                        @keyframes geoFloat4 {
                            0%, 100% { transform: translate(3%, 3%) scale(1.05); }
                            50% { transform: translate(-3%, -3%) scale(0.95); }
                        }
                    `;
                    document.head.appendChild(style);
                }

                for (let i = 0; i < shapeCount; i++) {
                    const shapeType = Math.floor(Math.random() * 3);
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    const opacity = 0.1 + Math.random() * 0.04; // 10-14% opacity

                    // Random position (biased towards bottom for visual weight)
                    let cx, cy;
                    const centerX = 960;
                    const centerY = 540;
                    const minDist = 200;

                    do {
                        cx = 100 + Math.random() * 1720;
                        // Bias towards bottom (60% of height range starts lower)
                        cy = 200 + Math.random() * 780;
                    } while (Math.sqrt((cx - centerX) ** 2 + (cy - centerY) ** 2) < minDist);

                    const size = 100 + Math.random() * 150;

                    let element;
                    if (shapeType === 0) {
                        element = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        element.setAttribute('cx', cx);
                        element.setAttribute('cy', cy);
                        element.setAttribute('r', size / 2);
                    } else if (shapeType === 1) {
                        element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                        element.setAttribute('x', cx - size / 2);
                        element.setAttribute('y', cy - size / 2);
                        element.setAttribute('width', size);
                        element.setAttribute('height', size * (0.7 + Math.random() * 0.6));
                        element.setAttribute('rx', size * 0.2);
                    } else {
                        element = document.createElementNS('http://www.w3.org/2000/svg', 'ellipse');
                        element.setAttribute('cx', cx);
                        element.setAttribute('cy', cy);
                        element.setAttribute('rx', size / 2);
                        element.setAttribute('ry', size / 2 * (0.5 + Math.random() * 0.5));
                    }

                    element.classList.add('geo-shape');
                    element.setAttribute('fill', color);
                    element.style.opacity = opacity;

                    // Use pre-defined animations
                    const animType = (i % 4) + 1;
                    const duration = 18 + Math.random() * 12;
                    const delay = Math.random() * 3;
                    element.style.animation = `geoFloat${animType} ${duration}s ease-in-out ${delay}s infinite`;

                    svg.appendChild(element);
                }
            }
        }

        function init() {
            console.log('Initializing...');

            // Get saved search engine preference before initializing UI
            const currentEngine = localStorage.getItem('searchEngine') || 'google';

            try {
                initTheme();
            } catch (e) {
                console.error('Theme init error:', e);
            }

            // Setup event listeners FIRST - this is critical
            try {
                setupEventListeners();
                console.log('Event listeners set up successfully');
            } catch (e) {
                console.error('Error setting up event listeners:', e);
            }

            // Initialize search engine UI from saved preference
            try {
                switchEngine(currentEngine);
            } catch (e) {
                console.error('Search engine init error:', e);
            }

            // Update time
            try {
                updateTime();
                setInterval(updateTime, 1000);
            } catch (e) {
                console.error('Time update error:', e);
            }

            // These can run asynchronously
            setTimeout(() => {
                fetchWeather().catch(e => console.error('Weather error:', e));
            }, 100);

            console.log('Init complete');
        }

        // Theme Management
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
            }
            // Default is dark mode (no attribute needed)

            // Generate geometric shapes after theme is set
            setTimeout(() => generateGeometricShapes(), 100);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);

            // Regenerate shapes when switching to light mode
            if (newTheme === 'light') {
                setTimeout(() => generateGeometricShapes(), 100);
            } else {
                // Clear shapes in dark mode
                const svg = document.getElementById('geoSvg');
                if (svg) svg.innerHTML = '';
            }
        }

        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const days = ['日', '一', '二', '三', '四', '五', '六'];
            const months = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];

            const timeEl = document.getElementById('time');
            const dateEl = document.getElementById('date');

            if (timeEl) timeEl.textContent = `${hours}:${minutes}`;
            if (dateEl) dateEl.textContent = `${months[now.getMonth()]}月${now.getDate()}日 周${days[now.getDay()]}`;

            // Update greeting message
            updateGreeting(now.getHours());

            // Update work countdown
            updateWorkCountdown(now);
        }

        // Update greeting based on time of day
        function updateGreeting(hour) {
            const greetingEl = document.getElementById('greeting');
            if (!greetingEl) return;

            const currentHours = hour;
            const currentTimeInMinutes = currentHours * 60;

            // Work schedule
            const morningStart = 8 * 60;
            const morningEnd = 11 * 60 + 20;
            const afternoonStart = 13 * 60 + 30;
            const afternoonEnd = 17 * 60;

            // Get current period key
            let periodKey;
            if (currentTimeInMinutes < morningStart) {
                periodKey = hour < 6 ? 'night' : (hour < 7 ? 'early_morning' : 'morning_prep');
            } else if (currentTimeInMinutes >= morningStart && currentTimeInMinutes < morningEnd) {
                periodKey = 'work_morning';
            } else if (currentTimeInMinutes >= morningEnd && currentTimeInMinutes < afternoonStart) {
                periodKey = 'lunch';
            } else if (currentTimeInMinutes >= afternoonStart && currentTimeInMinutes < afternoonEnd) {
                periodKey = hour < 15 ? 'work_afternoon_early' : (hour < 16 ? 'work_afternoon_mid' : 'work_afternoon_late');
            } else if (currentTimeInMinutes >= afternoonEnd && currentTimeInMinutes < afternoonEnd + 30) {
                periodKey = 'just_off_work';
            } else if (hour >= 18 && hour < 23) {
                periodKey = hour < 20 ? 'evening_early' : (hour < 22 ? 'evening_late' : 'night_rest');
            } else {
                periodKey = 'late_night';
            }

            // Check if we need to update (hour changed or first visit)
            const today = new Date().toDateString();
            const currentHour = hour;
            const cacheKey = `${today}-${currentHour}`;
            const cachedKey = localStorage.getItem('greetingCacheKey');
            const cachedGreeting = localStorage.getItem('greetingText');

            // If same hour and has cached greeting, use it
            if (cachedKey === cacheKey && cachedGreeting) {
                greetingEl.textContent = cachedGreeting;
                return;
            }

            // Define greetings for each period
            const greetingSets = {
                'night': [
                    '夜深了，注意休息',
                    '还不睡吗',
                    '熬夜对身体不好',
                    '早点休息吧',
                    '晚安世界'
                ],
                'early_morning': [
                    '早安新的一天',
                    '美好的一天开始',
                    '又是新的开始',
                    '元气满满的一天',
                    '起床奋斗啦'
                ],
                'morning_prep': [
                    '准备出发了吗',
                    '吃过早餐了吗',
                    '新的一天加油',
                    '今天也要努力',
                    '准备迎接挑战'
                ],
                'work_morning': [
                    '上午加油',
                    '专注工作',
                    '保持专注',
                    '今天要努力',
                    '上午状态满'
                ],
                'lunch': [
                    '午休时间到',
                    '放松一下',
                    '中午休息会儿',
                    '充电时间',
                    '享受午休'
                ],
                'work_afternoon_early': [
                    '下午继续',
                    '下午开工',
                    '保持节奏',
                    '下午冲刺',
                    '继续努力'
                ],
                'work_afternoon_mid': [
                    '坚持一下',
                    '快了快了',
                    '再坚持会儿',
                    '胜利在望',
                    '加把劲'
                ],
                'work_afternoon_late': [
                    '快要下班了',
                    '胜利在望',
                    '最后冲刺',
                    '马上自由',
                    '倒计时中'
                ],
                'just_off_work': [
                    '下班啦',
                    '终于下班',
                    '自由时间',
                    '下班快乐',
                    '辛苦一天了'
                ],
                'evening_early': [
                    '晚上好',
                    '晚上轻松',
                    '晚间时光',
                    '放松时刻',
                    '晚上愉快'
                ],
                'evening_late': [
                    '夜生活开始',
                    '晚上干什么',
                    '享受夜晚',
                    '夜晚模式',
                    '夜猫子时间'
                ],
                'night_rest': [
                    '该休息了',
                    '早点睡吧',
                    '准备睡觉',
                    '夜深了',
                    '晚安'
                ],
                'late_night': [
                    '夜深了',
                    '还在熬夜',
                    '注意身体',
                    '很晚了',
                    '休息吧'
                ]
            };

            // Get greetings for current period
            const greetings = greetingSets[periodKey] || greetingSets['late_night'];

            // Use cacheKey as seed for consistent selection
            const seed = cacheKey;
            let hash = 0;
            for (let i = 0; i < seed.length; i++) {
                hash = ((hash << 5) - hash) + seed.charCodeAt(i);
                hash = hash & hash;
            }

            // Select greeting based on hash (same for this hour)
            const index = Math.abs(hash) % greetings.length;
            const greeting = greetings[index];

            // Update display
            greetingEl.textContent = greeting;

            // Cache it with current hour key
            localStorage.setItem('greetingCacheKey', cacheKey);
            localStorage.setItem('greetingText', greeting);
        }

        // Work countdown
        function updateWorkCountdown(now) {
            const currentHours = now.getHours();
            const currentMinutes = now.getMinutes();
            const currentTimeInMinutes = currentHours * 60 + currentMinutes;

            // Work schedule (in minutes from midnight)
            const morningStart = 8 * 60;      // 8:00
            const morningEnd = 11 * 60 + 20;   // 11:20
            const afternoonStart = 13 * 60 + 30; // 13:30
            const afternoonEnd = 17 * 60;      // 17:00

            let targetTime, label;

            if (currentTimeInMinutes < morningStart) {
                // Before morning work: countdown to work start
                targetTime = morningStart;
                label = '上班';
            } else if (currentTimeInMinutes >= morningStart && currentTimeInMinutes < morningEnd) {
                // Morning work: countdown to morning end
                targetTime = morningEnd;
                label = '午休';
            } else if (currentTimeInMinutes >= morningEnd && currentTimeInMinutes < afternoonStart) {
                // Lunch break: countdown to afternoon work
                targetTime = afternoonStart;
                label = '下午上班';
            } else if (currentTimeInMinutes >= afternoonStart && currentTimeInMinutes < afternoonEnd) {
                // Afternoon work: countdown to end of work
                targetTime = afternoonEnd;
                label = '下班';
            } else {
                // After work: countdown to tomorrow morning work
                targetTime = morningStart + 24 * 60; // Tomorrow 8:00 in minutes
                label = '明天上班';
            }

            const diffMinutes = targetTime - currentTimeInMinutes;

            // Format time difference
            if (diffMinutes <= 0) {
                const countdownEl = document.getElementById('workCountdown');
                if (countdownEl) countdownEl.textContent = `还有 ${label}`;
                return;
            }

            const hours = Math.floor(diffMinutes / 60);
            const minutes = diffMinutes % 60;

            let timeStr;
            if (hours > 0 && minutes > 0) {
                timeStr = `${hours} 小时 ${minutes} 分钟`;
            } else if (hours > 0) {
                timeStr = `${hours} 小时`;
            } else {
                timeStr = `${minutes} 分钟`;
            }

            const countdownEl = document.getElementById('workCountdown');
            if (countdownEl) countdownEl.innerHTML = `还有 <span class="highlight">${timeStr}</span> ${label}`;
        }

        // Location cache duration: 24 hours
        const LOCATION_CACHE_DURATION = 24 * 60 * 60 * 1000;

        async function fetchWeather() {
            const QWEATHER_KEY = '362482f5b93749fd80282dba7cedb427';
            const weatherEl = document.getElementById('weather');

            // Loading state
            if (weatherEl) weatherEl.innerHTML = '<span class="loading-text">获取天气...</span>';

            try {
                let locationId, locationName;

                // Check cached location
                const cachedLocation = localStorage.getItem('weatherLocation');
                if (cachedLocation) {
                    const { id, name, timestamp } = JSON.parse(cachedLocation);
                    const cacheAge = Date.now() - timestamp;

                    // Use cached location if still valid (within 24 hours)
                    if (cacheAge < LOCATION_CACHE_DURATION) {
                        locationId = id;
                        locationName = name;
                    }
                }

                // If no valid cache, request geolocation
                if (!locationId) {
                    let position;
                    try {
                        position = await new Promise((resolve, reject) => {
                            if (!navigator.geolocation) {
                                reject(new Error('Geolocation not supported'));
                                return;
                            }
                            navigator.geolocation.getCurrentPosition(resolve, reject, {
                                timeout: 10000,
                                enableHighAccuracy: false
                            });
                        });
                    } catch (geoError) {
                        // User denied or geolocation failed
                        if (geoError.code === 1) {
                            // Permission denied
                            weatherEl.innerHTML = '<span class="weather-error" title="定位被拒绝，请在浏览器设置中允许定位">📍 未授权</span>';
                        } else {
                            throw geoError;
                        }
                        return;
                    }

                    const { latitude, longitude } = position.coords;

                    // Get location ID from coordinates (city lookup)
                    const geoRes = await fetch(`https://geoapi.qweather.com/v2/city/lookup?location=${longitude},${latitude}&key=${QWEATHER_KEY}`);
                    if (!geoRes.ok) throw new Error('Geo lookup failed');
                    const geoData = await geoRes.json();

                    if (geoData.code !== '200' || !geoData.location || geoData.location.length === 0) {
                        throw new Error('Location not found');
                    }

                    locationId = geoData.location[0].id;
                    locationName = geoData.location[0].name;

                    // Cache the location
                    localStorage.setItem('weatherLocation', JSON.stringify({
                        id: locationId,
                        name: locationName,
                        timestamp: Date.now()
                    }));
                }

                // Get current weather
                const weatherRes = await fetch(`https://devapi.qweather.com/v7/weather/now?location=${locationId}&key=${QWEATHER_KEY}`);
                if (!weatherRes.ok) throw new Error('Weather fetch failed');
                const weatherData = await weatherRes.json();

                if (weatherData.code !== '200' || !weatherData.now) {
                    throw new Error('Weather data invalid');
                }

                const now = weatherData.now;
                const temp = now.temp;
                const text = now.text;

                weatherEl.textContent = `${locationName} ${text} ${temp}°`;

            } catch (e) {
                console.error('Weather fetch error:', e);
                // Show friendly error message
                weatherEl.innerHTML = '<span class="weather-error" title="天气服务暂时不可用">🌤️ 服务异常</span>';
            }
        }

        // Search engines configuration
        const SEARCH_ENGINES = {
            google: {
                url: 'https://www.google.com/search?q=',
                placeholder: '今天想了解什么？'
            },
            bing: {
                url: 'https://www.bing.com/search?q=',
                placeholder: '用 Bing 探索世界'
            },
            baidu: {
                url: 'https://www.baidu.com/s?wd=',
                placeholder: '百度一下，找到你想要的'
            }
        };

        let currentEngine; // Will be set by switchEngine() in init()
        let selectedSuggestionIndex = -1;
        let suggestionDebounceTimer = null;

        // Search suggestion API callbacks (global functions for JSONP)
        window.googleSearchCallback = function(data) {
            const suggestions = data[1] || [];
            renderSuggestions(suggestions);
        };

        window.baiduSearchCallback = function(data) {
            if (data && data.s) {
                renderSuggestions(data.s);
            } else {
                renderSuggestions([]);
            }
        };

        // Suggestion API URLs for each engine
        const SUGGESTION_APIS = {
            google: (q) => `https://suggestqueries.google.com/complete/search?output=firefox&client=firefox&callback=googleSearchCallback&q=${encodeURIComponent(q)}`,
            baidu: (q) => `https://suggestion.baidu.com/su?wd=${encodeURIComponent(q)}&cb=baiduSearchCallback`,
            bing: (q) => `https://suggestqueries.google.com/complete/search?output=firefox&client=firefox&callback=googleSearchCallback&q=${encodeURIComponent(q)}` // Bing uses Google for now
        };

        // Clean up old script tags
        function cleanupOldScripts() {
            const oldScripts = document.querySelectorAll('script[data-suggestion="true"]');
            oldScripts.forEach(script => {
                if (script.parentNode) {
                    script.parentNode.removeChild(script);
                }
            });
        }

        async function fetchSuggestions(query) {
            if (!query || query.length < 1) {
                hideSuggestions();
                return;
            }

            // Clear previous timer
            if (suggestionDebounceTimer) {
                clearTimeout(suggestionDebounceTimer);
            }

            // Debounce: wait 300ms after user stops typing
            suggestionDebounceTimer = setTimeout(() => {
                showSuggestionsLoading();

                // Clean up old scripts
                cleanupOldScripts();

                // Use the appropriate API for current engine
                const apiFunc = SUGGESTION_APIS[currentEngine] || SUGGESTION_APIS.google;
                const apiUrl = apiFunc(query);

                const script = document.createElement('script');
                script.src = apiUrl;
                script.setAttribute('data-suggestion', 'true');
                script.onerror = () => {
                    hideSuggestions();
                };
                document.body.appendChild(script);

                // Fallback: if no response after 2 seconds, hide loading
                setTimeout(() => {
                    const loadingEl = document.querySelector('.suggestion-loading');
                    if (loadingEl) {
                        renderSuggestions([]); // Show empty state
                    }
                }, 2000);
            }, 300);
        }

        function showSuggestionsLoading() {
            const suggestionsEl = document.getElementById('searchSuggestions');
            const listEl = document.getElementById('suggestionList');

            if (!suggestionsEl || !listEl) return;

            listEl.innerHTML = '<div class="suggestion-loading"><div class="loading-spinner"></div><span>加载中...</span></div>';
            suggestionsEl.classList.add('show');
        }

        function renderSuggestions(suggestions) {
            const suggestionsEl = document.getElementById('searchSuggestions');
            const listEl = document.getElementById('suggestionList');

            if (!suggestionsEl || !listEl) return;

            if (suggestions.length === 0) {
                listEl.innerHTML = `
                    <div class="suggestion-empty-hint">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="11" y1="14" x2="11" y2="14"/></svg>
                        <div>输入关键词获取搜索建议</div>
                    </div>
                `;
            } else {
                listEl.innerHTML = suggestions.slice(0, 8).map((suggestion, i) => {
                    return `
                        <div class="suggestion-item" data-index="${i}" data-query="${suggestion}">
                            <svg class="suggestion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                            <span class="suggestion-text">${suggestion}</span>
                        </div>
                    `;
                }).join('');
            }

            suggestionsEl.classList.add('show');
            selectedSuggestionIndex = -1;
        }

        function hideSuggestions() {
            const suggestionsEl = document.getElementById('searchSuggestions');
            if (suggestionsEl) suggestionsEl.classList.remove('show');
            selectedSuggestionIndex = -1;
        }

        function performSearch(query = null) {
            const q = query || document.getElementById('searchInput').value.trim();
            if (q) {
                hideSuggestions();
                const url = q.match(/^https?:\/\//) || q.match(/^[a-zA-Z0-9-]+\.[a-zA-Z]{2,}/)
                    ? (q.match(/^https?:\/\//) ? q : `https://${q}`)
                    : `${SEARCH_ENGINES[currentEngine].url}${encodeURIComponent(q)}`;
                window.open(url, '_blank');
                document.getElementById('searchInput').value = '';
                updateClearButton();
            }
        }

        function updateClearButton() {
            const input = document.getElementById('searchInput');
            const clearBtn = document.getElementById('clearSearch');
            if (input && clearBtn) {
                clearBtn.style.display = input.value ? 'flex' : 'none';
            }
        }

        function switchEngine(engine) {
            currentEngine = engine;
            // Save to localStorage
            localStorage.setItem('searchEngine', engine);
            document.querySelectorAll('.engine-option').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.engine === engine);
            });
            document.getElementById('searchInput').placeholder = SEARCH_ENGINES[engine].placeholder;
        }

        function setupEventListeners() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');
            const clearBtn = document.getElementById('clearSearch');
            const suggestionsEl = document.getElementById('searchSuggestions');

            // Search input events
            if (searchInput) {
                searchInput.addEventListener('keypress', e => {
                    if (e.key === 'Enter') {
                        if (selectedSuggestionIndex >= 0) {
                            const selected = document.querySelector('.suggestion-item.selected');
                            if (selected) {
                                performSearch(selected.dataset.query);
                            } else {
                                performSearch();
                            }
                        } else {
                            performSearch();
                        }
                    }
                });

                searchInput.addEventListener('input', () => {
                    updateClearButton();
                    const value = searchInput.value.trim();
                    if (value) {
                        fetchSuggestions(value);
                    } else {
                        hideSuggestions();
                    }
                });

                searchInput.addEventListener('focus', () => {
                    const value = searchInput.value.trim();
                    if (value) {
                        fetchSuggestions(value);
                    }
                });

                // Keyboard navigation
                searchInput.addEventListener('keydown', e => {
                    if (suggestionsEl && suggestionsEl.classList.contains('show')) {
                        const items = document.querySelectorAll('.suggestion-item');

                        if (e.key === 'ArrowDown') {
                            e.preventDefault();
                            selectedSuggestionIndex = Math.min(selectedSuggestionIndex + 1, items.length - 1);
                            updateSelection(items);
                        } else if (e.key === 'ArrowUp') {
                            e.preventDefault();
                            selectedSuggestionIndex = Math.max(selectedSuggestionIndex - 1, -1);
                            updateSelection(items);
                        } else if (e.key === 'Escape') {
                            hideSuggestions();
                        }
                    }
                });
            }

            // Clear button
            if (clearBtn) {
                clearBtn.addEventListener('click', () => {
                    if (searchInput) {
                        searchInput.value = '';
                        updateClearButton();
                        searchInput.focus();
                    }
                });
            }

            // Suggestion click events
            suggestionsEl?.addEventListener('click', e => {
                const item = e.target.closest('.suggestion-item');
                if (item) {
                    performSearch(item.dataset.query);
                }
            });

            // Search button
            if (searchBtn) searchBtn.addEventListener('click', () => performSearch());

            // Engine selector
            document.querySelectorAll('.engine-option').forEach(btn => {
                btn.addEventListener('click', () => switchEngine(btn.dataset.engine));
            });

            // Hide suggestions when clicking outside
            document.addEventListener('click', e => {
                if (searchInput && suggestionsEl && !searchInput.contains(e.target) && !suggestionsEl.contains(e.target)) {
                    hideSuggestions();
                }
            });

            // Global keyboard shortcuts
            document.addEventListener('keydown', e => {
                if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                    e.preventDefault();
                    if (searchInput) searchInput.focus();
                }
            });

            // Theme toggle
            const themeToggle = document.getElementById('themeToggle');
            if (themeToggle) themeToggle.addEventListener('click', toggleTheme);

            // Scroll hint - hide when scrolled
            const container = document.getElementById('quickLinksContainer');
            const scrollHint = document.getElementById('scrollHint');
            if (container && scrollHint) {
                container.addEventListener('scroll', () => {
                    if (container.scrollLeft > 50) {
                        scrollHint.style.opacity = '0';
                    } else {
                        scrollHint.style.opacity = '1';
                    }
                });
            }
        }

        function updateSelection(items) {
            items.forEach((item, index) => {
                item.classList.toggle('selected', index === selectedSuggestionIndex);
            });

            // Scroll selected item into view
            if (selectedSuggestionIndex >= 0 && items[selectedSuggestionIndex]) {
                const selectedItem = items[selectedSuggestionIndex];
                const listContainer = document.getElementById('suggestionList');
                if (listContainer) {
                    const listRect = listContainer.getBoundingClientRect();
                    const itemRect = selectedItem.getBoundingClientRect();

                    // If item is above visible area
                    if (itemRect.top < listRect.top) {
                        listContainer.scrollTop -= (listRect.top - itemRect.top);
                    }
                    // If item is below visible area
                    else if (itemRect.bottom > listRect.bottom) {
                        listContainer.scrollTop += (itemRect.bottom - listRect.bottom);
                    }
                }
            }
        }

        init();
    </script>
</body>
</html>
